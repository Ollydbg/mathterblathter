using System;
using Client.Game.Attributes;
using UnityEngine;
using System.Linq;
using Client.Game.Abilities.Payloads;

namespace Client.Game.Abilities.Scripts
{
	public class InvulnerabilityBuff : BuffBase
	{
		public InvulnerabilityBuff ()
		{
		}

		#region implemented abstract members of AbilityBase
		float timeLeft;
		public override void Start ()
		{
			this.context.source.Attributes[ActorAttributes.TakesDamage] = false;
			this.timeLeft = this.Attributes[AbilityAttributes.Duration];

		}

		public override void Update (float dt)
		{
			timeLeft -= dt;

		}

		public override bool IsComplete ()
		{
			return timeLeft <= 0;
		}

		public override bool OnPayloadReceive (Payload payload)
		{
			return payload is DamagePayload;
		}

		public override void End ()
		{
			this.context.source.Attributes[ActorAttributes.TakesDamage] = true;
		}

		#endregion
	}
}

